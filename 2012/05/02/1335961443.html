<!DOCTYPE html>
<html>
  <head>
    <title>
      KS Sample
    </title>
    <meta chearset="UTF-8" />
    <meta content="IE=edge;chrome=1" http-equiv="X-UA-Compatible" />
    <link href="/css/kickstart.css" media="all" rel="stylesheet" type="text/css" />
    <link href="/style.css" media="all" rel="stylesheet" type="text/css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" type="text/javascript"></script>
    <script src="/javascripts/kickstart.js" type="text/javasript"></script>
  </head>
  <body class="elements">
    <div class="callout clearfix">
      <h1>
        びぼーろく（仮）
      </h1>
      <div class="grid">
        <div class="col_12">
          <ul class="tabs right">
            <li>
              <a href="tab_blog"><i class="icon-file"></i>BLOG</a>
            </li>
            <li>
              <a href="tab_socials"><i class="icon-twitter"></i>SOCIALS</a>
            </li>
            <li>
              <a href="https://github.com/kaakaa/middleman-blog-slim-sample/tree/gh-pages"><i class="icon-github"></i>View on Gitub</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="grid">
      <div class="col_12"><p><a href="http://d.hatena.ne.jp/fits/20080502/1209726765">継続的インテグレーションツール Hudson のプラグインを作成 - なんとなくな
Developer のメモ</a></p>

<p>ここに書いてあるファイルを作成してmvn
packageすると文字化けでコンパイルエラー吐いてて、先に進めなかった。</p>

<pre><code>[ERROR] COMPILATION ERROR : 
[INFO] -------------------------------------------------------------
[ERROR] /Users/kaakaa_hoe/Documents/jenkins_dev/simpleTest/src/main/java/simple/JavaNcssPublisher.java:[15,7] simple.JavaNcssPublisher ?? abstract ?łȂ??Ahudson.tasks.BuildStep ???? abstract ???\?b?h getRequiredMonitorService() ???I?[?o?[???C?h???܂???B
[ERROR] /Users/kaakaa_hoe/Documents/jenkins_dev/simpleTest/src/main/java/simple/JavaNcssPublisher.java:[38,12] ?V???{???????????܂???B
?V???{??: ?N???X JavaNcssAction
?ꏊ    : simple.JavaNcssPublisher ?? ?N???X
[ERROR] /Users/kaakaa_hoe/Documents/jenkins_dev/simpleTest/src/main/java/simple/JavaNcssPublisher.java:[38,37] ?V???{???????????܂???B
?V???{??: ?N???X JavaNcssAction
?ꏊ    : simple.JavaNcssPublisher ?? ?N???X
</code></pre>

<p>保存する時の文字コード変えてみたり、pom.xmlに文字コード指定してみたりしたけど治らなかったが、この記事のように文字コード指定したら上手く行った。</p>

<p><a href="http://d.hatena.ne.jp/ikeike443/20120319/p1">MacでMaven使うと文字コードでハマったりとか -
複雑系スパゲティソース(はてな版)</a></p>

<p>ん～pom.xmlでの文字コード指定と、実行時にオプションで指定するのでは何が違うのかよく分からんが上手く行ったのでまーよしとする。</p>

<p>\</p>

<p>これで良しと思いきや、まだまだエラーが出たりする。</p>

<pre><code>[INFO] Compiling 3 source files to /Users/kaakaa_hoe/Documents/jenkins_dev/simpleTest/target/classes
[INFO] -------------------------------------------------------------
[ERROR] COMPILATION ERROR : 
[INFO] -------------------------------------------------------------
[ERROR] /Users/kaakaa_hoe/Documents/jenkins_dev/simpleTest/src/main/java/simple/JavaNcssPublisher.java:[15,7] simple.JavaNcssPublisher は abstract でなく、hudson.tasks.BuildStep 内の abstract メソッド getRequiredMonitorService() をオーバーライドしません。
[INFO] 1 error
</code></pre>

<p>これは元記事が古いせいですかね。</p>

<p>APIを参考にして、JavaNcssPublisher.javaに以下のメソッド追加してやったら上手くいった。</p>

<p>~~~~ {.syntax-highlight}
public BuildStepMonitor getRequiredMonitorService(){
    return BuildStepMonitor.BUILD;
}
~~~~</p>

<p><a href="http://javadoc.jenkins-ci.org/hudson/tasks/Builder.html">Builder (Jenkins main module 1.462
API)</a></p>

<p>んで、あとはサイトに書いてある通り。</p>

<p>Maven使ってビルドするにはpom.xmlが必要。</p>

<p>Mavenほとんど使ったこと無いから、以下のサイト参考に作った。</p>

<p>groupIdとartifactIDとnameタグの所は適宜変更する。</p>

<p><a href="http://d.hatena.ne.jp/cnaos/20100526/1274838431">mavenのレポートプラグインてんこ盛り設定 - Sacrificed &amp;
Exploited</a></p>

<p>~~~~ {.syntax-highlight}
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemalocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"></project></p>
<modelversion>4.0.0</modelversion>
<groupid>model-ant-projec</groupid>
<artifactid>model-ant-project</artifactid>
<version>1.0-SNAPSHOT</version>
<name>maven-report-example</name>

<pre><code>&lt;pluginRepositories&gt;
    &lt;pluginRepository&gt;
        &lt;id&gt;Codehaus repository&lt;/id&gt;
        &lt;url&gt;http://repository.codehaus.org/&lt;/url&gt;
    &lt;/pluginRepository&gt;
&lt;/pluginRepositories&gt;

&lt;properties&gt;
    &lt;maven.compiler.encoding&gt;UTF-8&lt;/maven.compiler.encoding&gt;
    &lt;maven.compiler.target&gt;1.6&lt;/maven.compiler.target&gt;
    &lt;maven.compiler.source&gt;1.6&lt;/maven.compiler.source&gt;
    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
    &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;
&lt;/properties&gt;

&lt;reporting&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
            &lt;artifactId&gt;javancss-maven-plugin&lt;/artifactId&gt;
            &lt;version&gt;2.0&lt;/version&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/reporting&gt;
</code></pre>
<p>&lt;/project&gt;
~~~~</p>

<p>こんな感じでプラグイン動かすことは出来た。</p>

<p>でも、結果画面が見当たらないというオチ \^\^;</p>

<p>調べてみる。</p>

<p>\</p>

<p>結果画面というより、先ずJavancss:reportで生成されるはずのファイルが生成されていなかったらしい。</p>

<p>Jenkinsビルドのコンソール見てみると、こんな一行が。</p>

<pre><code>[INFO] skip non existing resourceDirectory /Users/kaakaa_hoe/Documents/jenkins/SamplePlugin/work/jobs/sample/workspace/model-ant-project/src/test/resources
</code></pre>

<p>src/test/resourcesが存在しないとか言われてるらしいので、src/test/resources配下にソースを突っ込んで実行してみたら、javancss-raw-reort.xmlが吐かれた。</p>

<p>しかし、結果画面は出ない。</p>

<p><a href="http://b.hatena.ne.jp/entry/http://d.hatena.ne.jp" title="このエントリーをはてなブックマークに追加"><img src="http://b.st-hatena.com/images/entry-button/button-only.gif" alt="このエントリーをはてなブックマークに追加" /></a></p>

<p><a href="http://twitter.com/share">ツイートする</a></p>

      </div>
      <hr />
      <div class="col_12">
        <div class="col_4">
          <h4>
            Profile
          </h4>
          <img class="align-center" src="http://placehold.it/169x130/4D99E0/ffffff.png&text=full+width" />
          <p>
            live in Yokohama. Software Engineer. Java / Groovy / Ruby / Sinatra / Trac / Jenkins
          </p>
        </div>
        <div class="col_5">
          <h5>
            Recent Articles
          </h5>
          <ul class="alt">
            <li>
              <a href="/2013/10/10/webfrontier_seminar.html">2013年秋 Web開発最前線テックトーク</a>
            </li>
            <li>
              <a href="/2013/10/07/example-article.html">Example Article</a>
            </li>
            <li>
              <a href="/2013/10/06/example-article.html">Example Article</a>
            </li>
            <li>
              <a href="/2013/10/05/example-article.html">Example Article</a>
            </li>
            <li>
              <a href="/2013/09/24/1380029870.html">Githubリポジトリのデフォルトブランチを変更する</a>
            </li>
            <li>
              <a href="/2013/09/15/20130915.html">Sinatraアプリを定期的に実行するために泥臭く行ってみた</a>
            </li>
            <li>
              <a href="/2013/09/10/20130910.html">Node.js(Express)でフィードアグリゲータを作り始め</a>
            </li>
            <li>
              <a href="/2013/09/03/20130903.html">SinatraでFeedAggregator</a>
            </li>
            <li>
              <a href="/2013/08/19/1376919346.html">社内勉強会 - 書籍管理Webシステム</a>
            </li>
            <li>
              <a href="/2013/07/18/1374154333.html">Gitbucket1.2で500エラー</a>
            </li>
            <li>
              <a href="/2013/06/24/20130624.html">社内勉強会 - chef</a>
            </li>
          </ul>
        </div>
        <div class="col_3">
          <h5>
            By Year
          </h5>
          <ul class="alt">
            <li>
              <a href="/2013.html">2013</a>(25)
            </li>
            <li>
              <a href="/2012.html">2012</a>(81)
            </li>
            <li>
              <a href="/2011.html">2011</a>(31)
            </li>
          </ul>
        </div>
      </div>
    </div>
    <hr />
    <div class="footer">
      <p>
        &copy; Copyright 2013 kaakaa
      </p>
    </div>
  </body>
</html>