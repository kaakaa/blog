<!DOCTYPE html>
<html>
  <head>
    <title>
      KS Sample
    </title>
    <meta chearset="UTF-8" />
    <meta content="IE=edge;chrome=1" http-equiv="X-UA-Compatible" />
    <link href="/css/kickstart.css" media="all" rel="stylesheet" type="text/css" />
    <link href="/style.css" media="all" rel="stylesheet" type="text/css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" type="text/javascript"></script>
    <script src="/javascripts/kickstart.js" type="text/javasript"></script>
  </head>
  <body class="elements">
    <div class="callout clearfix">
      <h1>
        びぼーろく（仮）
      </h1>
      <div class="grid">
        <div class="col_12">
          <ul class="tabs right">
            <li>
              <a href="tab_blog"><i class="icon-file"></i>BLOG</a>
            </li>
            <li>
              <a href="tab_socials"><i class="icon-twitter"></i>SOCIALS</a>
            </li>
            <li>
              <a href="https://github.com/kaakaa/middleman-blog-slim-sample/tree/gh-pages"><i class="icon-github"></i>View on Gitub</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="grid">
      <div class="col_12"><p>備忘録として。</p>

<p><a href="http://srz-zumix.blogspot.jp/search?q=Google+Test">ブログズミ: Google
Testの検索結果</a></p>

<p><a href="http://d.hatena.ne.jp/kaorun55/20111009/1318066141">TDD Boot Camp 東京 for C++ に参加 &amp; 講演してきました #tddbc -
かおるんダイアリー</a></p>

<h4 id="section">準備</h4>

<p>下の@kaorunさんのリンクの方が簡単そうなので、そっちでやってみることに。</p>

<p>BitBucketからzipをダウンロードして解凍。</p>

<p>解凍後のディレクトリの名前を"google_test_and_mock"に変更して、Cドライブ直下へ。</p>

<p>これからはテストを実行するプロジェクトにgoogle_test_and_mock/gtest_gmock.propsを適用していけば、google
testを実行できるはず。</p>

<p>propsの適用方法はコチラ。</p>

<p><a href="http://msdn.microsoft.com/ja-jp/library/vstudio/3z7t21ew.aspx">方法 : プロパティ
シートからプロジェクト設定を継承する</a></p>

<h4 id="section-1">ビルド</h4>

<p>プロジェクト新規作成して、上記リンクの方法でprops適用してビルドかけたらエラー。</p>

<pre><code>error MSB3073: コマンド "c:\users\kaakaa_hoe\documents\visual studio 2012\Projects\KaorunTest\Debug\KaorunTest.exe
:VCEnd" はコード 9009 で終了しました。
</code></pre>

<p>これはgtest_gmock.propsで</p>

<pre><code>&lt;Command&gt;$(TargetDir)$(TargetFileName)&lt;/Command&gt;
</code></pre>

<p>という記述があり、この$(TargetFileName)の示すパスに空白が入っていたのが原因でした。</p>

<p>なので、下記のよう修正。</p>

<pre><code>&lt;Command&gt;"$(TargetDir)$(TargetFileName)"&lt;/Command&gt;
</code></pre>

<p>これでビルドが通るようになりました</p>

<h4 id="section-2">実行</h4>

<p>ビルド時のエラーを回避し、下記のコードで実行確認。</p>

<p>~~~~ {.syntax-highlight}
#include &lt;gtest/gtest.h&gt;</p>

<p>TEST( TestSample, add )
{
    EXPECT_EQ( 0, 1 );
}
~~~~</p>

<p>実行すると、エラー。</p>

<pre><code>「fatal error LNK1112: モジュールのコンピューターの種類 'X64′ は対象コンピューターの種類 'x86′ と競合しています。
</code></pre>

<p>落としてきたgmockモジュールがX64環境でビルドされていることが原因らしい。</p>

<p>なので、gmockのソリューションをX86環境でビルドすることに。</p>

<p>google_test_and_mock\gmock-1.6.0\msvc\2010\gmock.slnをVisual
Studioで開き、各プロジェクトの設定からプリプロセッサの定義に「_VARIADIC_MAX=10」を追加。</p>

<p><a href="http://stackoverflow.com/questions/8274588/c2977-stdtuple-too-many-template-arguments-msvc11">c++ - C2977: 'std::tuple' : too many template arguments (MSVC11) -
Stack
Overflow</a></p>

<p>そして、ソリューションのリビルド。</p>

<p>google_test_and_mock\gmock-1.6.0\msvc\2010\Debug\Win32に生成された２つのlibファイル（gmock.lib,
gmock_main.lib）をひとつ上のディレクトリに移動し、準備完了。</p>

<p>これでとりあえず実行することはできました。</p>

<p><a href="http://b.hatena.ne.jp/entry/http://d.hatena.ne.jp" title="このエントリーをはてなブックマークに追加"><img src="http://b.st-hatena.com/images/entry-button/button-only.gif" alt="このエントリーをはてなブックマークに追加" /></a></p>

<p><a href="http://twitter.com/share">ツイートする</a></p>

      </div>
      <hr />
      <div class="col_12">
        <div class="col_4">
          <h4>
            Profile
          </h4>
          <img class="align-center" src="http://placehold.it/169x130/4D99E0/ffffff.png&text=full+width" />
          <p>
            live in Yokohama. Software Engineer. Java / Groovy / Ruby / Sinatra / Trac / Jenkins
          </p>
        </div>
        <div class="col_5">
          <h5>
            Recent Articles
          </h5>
          <ul class="alt">
            <li>
              <a href="/2013/10/10/webfrontier_seminar.html">2013年秋 Web開発最前線テックトーク</a>
            </li>
            <li>
              <a href="/2013/10/07/example-article.html">Example Article</a>
            </li>
            <li>
              <a href="/2013/10/06/example-article.html">Example Article</a>
            </li>
            <li>
              <a href="/2013/10/05/example-article.html">Example Article</a>
            </li>
            <li>
              <a href="/2013/09/24/1380029870.html">Githubリポジトリのデフォルトブランチを変更する</a>
            </li>
            <li>
              <a href="/2013/09/15/20130915.html">Sinatraアプリを定期的に実行するために泥臭く行ってみた</a>
            </li>
            <li>
              <a href="/2013/09/10/20130910.html">Node.js(Express)でフィードアグリゲータを作り始め</a>
            </li>
            <li>
              <a href="/2013/09/03/20130903.html">SinatraでFeedAggregator</a>
            </li>
            <li>
              <a href="/2013/08/19/1376919346.html">社内勉強会 - 書籍管理Webシステム</a>
            </li>
            <li>
              <a href="/2013/07/18/1374154333.html">Gitbucket1.2で500エラー</a>
            </li>
            <li>
              <a href="/2013/06/24/20130624.html">社内勉強会 - chef</a>
            </li>
          </ul>
        </div>
        <div class="col_3">
          <h5>
            By Year
          </h5>
          <ul class="alt">
            <li>
              <a href="/2013.html">2013</a>(25)
            </li>
            <li>
              <a href="/2012.html">2012</a>(81)
            </li>
            <li>
              <a href="/2011.html">2011</a>(31)
            </li>
          </ul>
        </div>
      </div>
    </div>
    <hr />
    <div class="footer">
      <p>
        &copy; Copyright 2013 kaakaa
      </p>
    </div>
  </body>
</html>